<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../../bower_components/core-list/core-list.html">
<link rel="import" href="../../../bower_components/paper-tabs/paper-tabs.html">

<link rel="import" href="../../../bower_components/firebase-element/firebase-element.html">

<link rel="import" href="../gdg-session-list/gdg-session-list.html">
<link rel="import" href="../gdg-animation-globals/gdg-animation-globals.html">


<polymer-element name="gdg-home-page" attributes="router">

  <template>
    <link rel="stylesheet" href="gdg-home-page.css">

    <gdg-animation-globals values="{{animGlobals}}"></gdg-animation-globals>



    <section id="mainContainer" cross-fade>

      <!-- Hero Banner -->
      <section class="page-section__hero">

        <div class="hero-container" id="heroContainer">
          <div class="logo-container">

            <div class="chevron-container">
              <img src="../../images/gdg_chevron_left.svg">

              <div class="logo-text-container">
                <div class="logo-text">
                  <span class="title">GDG DevFest</span> <!-- Hidden at first -->
                  <span class="year">2015</span>
                </div>
              </div>

              <img src="../../images/gdg_chevron_right.svg">
            </div>

          </div>

          <p class="description">Saturday, March 21, 2015 @ 8am - 5pm</p>
        </div>

      </section>

      <!-- Tabs to toggle full schedule vs favorites -->
      <core-toolbar>
        <paper-tabs id="scheduleTabs" selected="list" self-end>
          <paper-tab name="list">Scheduled Events</paper-tab>
          <paper-tab name="favorites">My Favorites</paper-tab>
        </paper-tabs>

      </core-toolbar>

      <!-- Schedule -->
      <section class="content-layout-container">
          <gdg-session-list id="sessionsList" router="{{router}}"></gdg-session-list>
      </section>

    </section>


  </template>

  <script>
    (function (Polymer, undefined) {


      ////// TODO: Put this function in its own separate file
      function animateHero(elem) {

        var logoEntranceDuration = elem.animGlobals.BASE_DURATION * 0.8,
          heroContainer = elem.$.heroContainer,
          logoContainer = heroContainer.querySelector('.logo-container'),
          heroDescription = heroContainer.querySelector('.description'),
          chevrons = heroContainer.querySelectorAll('.chevron-container img'),
          logoYear = heroContainer.querySelector('.logo-text .year'),
          logoTitle = heroContainer.querySelector('.logo-text .title');


        var timeline = new TimelineMax();
        //timeline.delay(0.5);

        timeline.to(logoContainer, 0, { opacity: 1 });

        timeline.from(
          chevrons,
          logoEntranceDuration,
          {
            scale: 0,
            opacity: 0,
            ease: Back.easeOut.config(1)
          }
        );

        timeline.fromTo(
          logoYear,
          logoEntranceDuration,
          {
            fontSize: '0px',
            opacity: 0,
            display: 'block'
          },
          {
            fontSize: '1em',
            opacity: 1,
            ease: Back.easeOut.config(1)
          },
          '-=' + logoEntranceDuration
        );

        /////////// Expand Text //////////

        timeline.fromTo(
          logoTitle,
          elem.animGlobals.BASE_DURATION,
          {
            fontSize: '0px',
            opacity: 0,
            display: 'none'
          },
          {
            display: 'block',
            opacity: 1,
            fontSize: '1em',
            ease: Back.easeOut.config(1.7)
          }
        );

        timeline.to(
          heroDescription,
          logoEntranceDuration,
          {
            fontSize: '1em',
            opacity: 1
          },
          '+=0.5'
        );
      }



      Polymer('gdg-home-page', {

        devfestStartTime: "",

        _animateHero: function (elem) {
          window.requestAnimationFrame(function () {
            animateHero(elem);
          });
        },

        ready: function () {

          this.devfestStartTime = new Date(2015, 2, 21, 7);
          var tabs = this.$.mainContainer.querySelector('paper-tabs');

          // Only show favorited events when the user selects the 'favorites' tab
          tabs.addEventListener('core-select', function () {
            this.fire('core-signal', {name: 'view-mode', data: tabs.selected});
          });
          this._animateHero(this);  // wrap hero animation in RAF -- the closure of "this" being the Polymer element
        },

        domReady: function () {
          //var heroContainer = this.$.heroUnit;
          //animateHero(this);
        }

      });
    }(Polymer));

  </script>

</polymer-element>
